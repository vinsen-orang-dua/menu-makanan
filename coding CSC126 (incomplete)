/* CSC126
Created on: 1/1/2025
Created by: Ethelbert, A.Rahman, Marxamos, Ronny
Purpose: Prepare a more efficient method of ordering.
         1.lists of menus
         2.Order taking
         4.Total Purchase Calculation
         5.Display Order details
         6.Calculate Change based on Payment method
*/

#include <iostream>
#include <string>
#include <iomanip> //for setprecision
#include <ctype.h> //for toupper
using namespace std;

// Greeting and Menu Function Prototypes
void greetings();
void MainMenu();
// Admin Function Protoypes
void adminLogin();
// Customer Function Prototypes
void customerLogin();
void TableMenu();
void Order(string name[], int qtyStore[], double &tprice, int &i);
void TotalPurchase(double &tprice);
void Output(string name[], int qtyStore[], double tprice, int i);
void Change(double tprice);
string toUpperCase(const string &str);

// Global variables
string name[100];       // Array to store item names
double tprice = 0.0;    // Total price
int i = 0;              // Counter for items
int qtyStore[100];      // Array to store quantity for each item
string passM = "12345"; // Admin password

int main()
{
    greetings(); // Display greetings
    MainMenu();
    /*TableMenu(); //Display lists of menus
    Order(name, tprice, i); //Take order from customer
    TotalPurchase(tprice); //Calculate total price & apply discount
    Output(name, tprice, i); //Display the order details
    Change(tprice); //Handle payment method and calculate change if have*/

    return 0;
}

// greetings Function
void greetings()
{
    char key;
    cout << "+----------------------------------------+" << endl;
    cout << "|     WELCOME   TO   CAFE KAPAL LAUD     |" << endl;
    cout << "+----------------------------------------+" << endl;
    cout << "Press any key [Q] to continue..." << endl;
    cin >> key;
    getchar();
}

// MainMenu Function
void MainMenu()
{
    char userType;

    do
    {
        cout << endl;
        cout << "+-------------------------------------+" << endl;
        cout << "|              MAIN MENU              |" << endl;
        cout << "+--------+----------------------------+" << endl;
        cout << "|    1   |       Administrator        |" << endl;
        cout << "+--------+----------------------------+" << endl;
        cout << "|    2   |       Customer             |" << endl;
        cout << "+--------+----------------------------+" << endl;
        cout << "|    X   |       Exit                 |" << endl;
        cout << "+-------------------------------------+" << endl;
        cout << "Login as: ";
        cin >> userType;

        if (userType == '1')
            adminLogin();
        else if (userType == '2')
            customerLogin();
        else if (toupper(userType) == 'X')
        {
            cout << "Thank you!!!";
            exit(0); // terminate program
        }
        else
            cout << "Incorrect. Please enter again.";
    } while (toupper(userType) != 'X');
}

// Customer Login Function
void customerLogin()
{
    char opt;

    cout << "+--------+-------------------------+" << endl;
    cout << "|    O   |     [O] Order           |" << endl;
    cout << "|--------+-------------------------|" << endl;
    cout << "|    M   |     [M] Main Menu       |" << endl;
    cout << "+----------------------------------+" << endl;
    cout << "Enter your choice: ";
    cin >> opt;

    if (toupper(opt) == 'M')
        MainMenu();
    if (toupper(opt) == 'O')
        TableMenu();                  // Display lists of Menus
    Order(name, qtyStore, tprice, i); // Take order from customer
}

// TableMenu Function
void TableMenu()
{
    cout << endl;
    cout << "                                             WELCOME CUSTOMER !                                               " << endl;
    cout << "+------------------------------------------------------------------------------------------------------------+" << endl;
    cout << "|  Category  |        Food             |      Price        |            |       Beverages       |    Price   |" << endl;
    cout << "|------------|-------------------------|-------------------|------------|-----------------------|------------|" << endl;
    cout << "|   Code     |       [Burger]          |                   |    Code    |    [Minuman Bujang]   |            |" << endl;
    cout << "|------------|-------------------------|-------------------|------------|-----------------------|------------|" << endl;
    cout << "|     A      |         Ayam            |     RM 5.00       |     WJ     |   Watermelon Juice    |   RM 7.00  |" << endl;
    cout << "|------------|-------------------------|-------------------|------------|-----------------------|------------|" << endl;
    cout << "|     AT     |      Ayam + Telur       |     RM 6.00       |     HJ     |    Honeydew Juice     |   RM 8.00  |" << endl;
    cout << "|------------|-------------------------|-------------------|------------|-----------------------|------------|--------------+" << endl;
    cout << "|     ATC    |  Ayam + Telur + Cheese  |     RM 7.00       |            |    [Minuman Lega]     |     Hot    |     Cold     |" << endl;
    cout << "|------------|-------------------------|-------------------|------------|-----------------------|------------|--------------|" << endl;
    cout << "|     D      |      Burger Daging      |     RM 5.00       |     TC     |         Teh C         |   RM 4.50  |   RM 5.00    |" << endl;
    cout << "|------------|-------------------------|-------------------|------------|-----------------------|------------|--------------|" << endl;
    cout << "|     DT     |  Burger Daging + Telur  |     RM 6.00       |     LT     |       Lemon Tea       |   RM 4.50  |   RM 5.00    |" << endl;
    cout << "|------------|-------------------------|-------------------|----------------------------------------------------------------+" << endl;
    cout << "|     DTC    |  Burger Daging + Telur  |     RM 7.00       |" << endl;
    cout << "|            |       + Cheese          |                   |" << endl;
    cout << "|------------|-------------------------|-------------------|" << endl;
    cout << "|            |       [Spaghetti]       |                   |" << endl;
    cout << "|------------|-------------------------|-------------------|" << endl;
    cout << "|      C     |        Carbonara        |     RM 13.95      |" << endl;
    cout << "|------------|-------------------------|-------------------|" << endl;
    cout << "|      B     |        Bolognese        |     RM 13.95      |" << endl;
    cout << "+----------------------------------------------------------+" << endl;
}
// Order Function
void Order(string name[], int qtyStore[], double &tprice, int &i)
{
    string category, FoodCode, bvgCode, temp;
    int qty;
    double price;

    do
    {
        cout << endl;
        cout << "+--------------------------------+" << endl;
        cout << "|    1   |     [F] Food          |" << endl;
        cout << "|--------+-----------------------|" << endl;
        cout << "|    2   |     [B] Beverages     |" << endl;
        cout << "|--------+-----------------------|" << endl;
        cout << "|    3   |     [FM] Food Menu    |" << endl;
        cout << "|--------+-----------------------|" << endl;
        cout << "|    4   |     [C] Confirm Order |" << endl;
        cout << "|--------+-----------------------|" << endl;
        cout << "|    5   |     [M] Main Menu     |" << endl;
        cout << "+--------------------------------+" << endl;
        cout << "Please select your choice: ";
        cin >> category;
        category = toUpperCase(category);
        if (category == "1" || category == "F" || category == "FOOD")
        {
            cout << "\nEnter food code and quantity. " << endl;
            cout << "Enter DONE if you have finished. " << endl;
            do
            {
                cout << "Code: ";
                cin >> FoodCode;
                FoodCode = toUpperCase(FoodCode);
                if (FoodCode == "DONE")
                {
                    break;
                }

                if (FoodCode == "A")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Burger Ayam";
                    qtyStore[i] = qty;
                    price = 5.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "AT")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Burger Ayam Telur";
                    qtyStore[i] = qty;
                    price = 6.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "ATC")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Burger Ayam Telur Cheese";
                    qtyStore[i] = qty;
                    price = 7.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "D")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Burger Daging";
                    qtyStore[i] = qty;
                    price = 5.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "DT")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Burger Daging Telur";
                    qtyStore[i] = qty;
                    price = 6.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "DTC")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Burger Daging Telur Cheese";
                    qtyStore[i] = qty;
                    price = 7.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "C")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Spaghetti Carbonara";
                    qtyStore[i] = qty;
                    price = 13.95 * qty;
                    tprice += price;
                    i++;
                }
                else if (FoodCode == "B")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Spaghetti Bolognese";
                    qtyStore[i] = qty;
                    price = 13.95 * qty;
                    tprice += price;
                    i++;
                }
                else
                    cout << "Food Code not available" << endl;

            } while (true);
        }

        else if (category == "2" || category == "B" || category == "BEVERAGES")
        {
            cout << "\nEnter beverages code and quantity. " << endl;
            cout << "Enter DONE if you have finished. " << endl;
            do
            {
                cout << "Code: ";
                cin >> bvgCode;
                bvgCode = toUpperCase(bvgCode);

                if (bvgCode == "DONE")
                {
                    break;
                }

                if (bvgCode == "WJ")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Watermelon Juice";
                    qtyStore[i] = qty;
                    price = 7.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (bvgCode == "HJ")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    name[i] = "Honeydew Juice";
                    qtyStore[i] = qty;
                    price = 8.00 * qty;
                    tprice += price;
                    i++;
                }
                else if (bvgCode == "TC")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    do
                    {
                        cout << "Enter Hot or Cold: ";
                        cin >> temp;
                        temp = toUpperCase(temp);
                        if (temp == "HOT" || temp == "COLD")
                        {
                            if (temp == "HOT")
                            {
                                name[i] = "Teh C Hot";
                                qtyStore[i] = qty;
                                price = 4.50 * qty;
                                tprice += price;
                                i++;
                            }
                            else if (temp == "COLD")
                            {
                                name[i] = "Teh C Cold";
                                qtyStore[i] = qty;
                                price = 5.00 * qty;
                                tprice += price;
                                i++;
                            }
                        }
                        else
                        {
                            cout << "Invalid! Please enter again.";
                        }
                    } while (temp != "HOT" && temp != "COLD");
                }
                else if (bvgCode == "LT")
                {
                    cout << "Quantity: ";
                    cin >> qty;
                    do
                    {
                        cout << "Enter Hot or Cold: ";
                        cin >> temp;
                        temp = toUpperCase(temp);
                        if (temp == "HOT" || temp == "COLD")
                        {
                            if (temp == "HOT")
                            {
                                name[i] = "Lemon Tea Hot";
                                qtyStore[i] = qty;
                                price = 4.50 * qty;
                                tprice += price;
                                i++;
                            }
                            else if (temp == "COLD")
                            {
                                name[i] = "Lemon Tea Cold";
                                qtyStore[i] = qty;
                                price = 5.00 * qty;
                                tprice += price;
                                i++;
                            }
                        }
                        else
                        {
                            cout << "Invalid! Please enter again.";
                        }
                    } while (temp != "HOT" && temp != "COLD");
                }
                else
                    cout << "Beverages code not available." << endl;

            } while (true);
        }
        else if (category == "FM" || category == "3")
        {
            TableMenu();
        }
        else if (category == "M" || category == "5")
        {
            MainMenu();
        }
        else if (category == "C" || category == "4")
        {
            TotalPurchase(tprice); // Calculate total price & apply discount
        }
        else
        {
            cout << "Please enter a valid category." << endl;
        }
    } while (true);
}
// TotalPurchase Function
void TotalPurchase(double &tprice)
{
    cout << "======================================================" << endl;
    cout << "Your total price is: RM" << tprice << endl;
    if (tprice > 40.0)
    {
        tprice = tprice - (tprice * 0.1);
        cout << fixed << setprecision(2);
        cout << "You have received a 10% Discount." << endl;
    }
    else if (tprice == 0.0)
    {
        cout << "You have not purchased anything." << endl;
        MainMenu();
    }

    Output(name, qtyStore, tprice, i); // Display the order details
}
// Output Function
void Output(string name[], int qtyStore[], double tprice, int i)
{
    cout << "\n+==============+" << endl;
    cout << "|  Order List  | " << endl;
    cout << "+==============+" << endl;
    for (int j = 0; j < i; j++)
    {
        cout << j + 1 << ". " << name[j] << " - " << "x" << qtyStore[j] << endl;
    }
    cout << "Your total purchase is: RM" << tprice << endl;
    cout << "======================================================" << endl;

    Change(tprice); // Handle payment method and calculate change if have
}
// Change Function
void Change(double tprice)
{
    double amt, change = 0.0;
    char opt;

    cout << "\nChoose your Payment Method. " << endl;
    cout << "1.Cash" << endl;
    cout << "2.Debit" << endl;
    cout << "Enter 1 or 2: ";
    do
    {
        cin >> opt;

        if (opt == '1')
        {
            cout << "\nEnter amount: RM";
            do
            {
                cin >> amt;
                if (amt < tprice)
                {
                    cout << "Money not enough to pay please enter again: RM";
                }
                else if (amt > tprice)
                {
                    change = amt - tprice;
                    if (change > 0.0)
                    {
                        cout << "\nYou have RM" << change << " change." << endl;
                        cout << "Please go to counter to collect your change." << endl;
                        cout << "======================================================" << endl;
                        break;
                    }
                }
                else if (amt = tprice)
                {
                    cout << "\n\aNo change to collect" << endl;
                    cout << "======================================================" << endl;
                    break;
                }
            } while (true);
            break;
        }

        else if (opt == '2')
        {
            tprice = tprice - (tprice * 0.1);
            cout << fixed << setprecision(2);
            cout << "\a\nReceive 10% Discount" << endl;
            cout << "Total Price: RM" << tprice << endl;
            cout << "RM" << tprice << " has been deducted from your account." << endl;
            cout << "======================================================" << endl;
            break;
        }
        else
        {
            cout << "\nInvalid Option!! Please enter Again: ";
        }

    } while (true);
    MainMenu();
}
// AdminLogin Function
void adminLogin()
{
    char opt;
    string passlog;

    do
    {
        cout << "Enter password: ";
        cin >> passlog;

        if (passlog == passM)
        {

            cout << endl;
            cout << "Yo wassap" << endl;
            cout << "+------------------------------+" << endl;
            cout << "|    X   |        Exit         |" << endl;
            cout << "|--------+---------------------|" << endl;
            cout << "|    M   |      Main Menu      |" << endl;
            cout << "+------------------------------+" << endl;
            cout << "Enter your choice: ";
            cin >> opt;

            if (toupper(opt) == 'M')
                MainMenu();
            else if (toupper(opt) == 'X')
            {
                cout << "Thank you!!!";
                exit(0);
            }
        }
        else
            cout << "Entered wrong password." << endl;
    } while (passlog != passM);
}

string toUpperCase(const string &str)
{
    string result = str;
    for (char &ch : result)
    {
        ch = toupper(ch);
    }
    return result;
}
